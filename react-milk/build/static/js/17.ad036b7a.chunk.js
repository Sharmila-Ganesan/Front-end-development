(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[17],{100:function(e,t,a){"use strict";var n=a(12),r=a(13),c=a(15),i=a(14),s=a(0),o=a.n(s),u=function(e){Object(c.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.params,t=e.quantity,a=e.processed,n=Math.ceil(a/t*100);return n=isNaN(n)?0:n>100?100:n,o.a.createElement("div",{className:"sale-overflow"},o.a.createElement("div",{className:"row p-4 process-box  mb-55"},o.a.createElement("h3",{className:"col-12 p-1 "}," Processing..."),o.a.createElement("div",{className:"progress pbar"},o.a.createElement("div",{className:"progress-bar progress-bar-success progress-bar-striped ",role:"progressbar","aria-valuenow":n,"aria-valuemin":"0","aria-valuemax":"100",style:{width:"".concat(n,"%")}}," ".concat(n,"% Complete"))),o.a.createElement("h3",{className:"col-12 p-1"}," Processed ".concat(a," ml"))))}}]),a}(o.a.Component);t.a=u},101:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"e",(function(){return y})),a.d(t,"d",(function(){return g}));var n,r,c,i,s=a(25),o=a.n(s),u=a(33),l=a(91),d="6e400001-b5a3-f393-e0a9-e50e24dcca9e";function m(e,t){return p.apply(this,arguments)}function p(){return(p=Object(u.a)(o.a.mark((function e(t,a){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={acceptAllDevices:!0,optionalServices:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]},console.log("Getting device info"),e.next=4,navigator.bluetooth.requestDevice(r);case 4:if(n=e.sent){e.next=7;break}throw Object.assign(new Error("No device Found"),{code:404});case 7:n.addEventListener("gattserverdisconnected",a),console.log("device connected"),f(t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}return e.abrupt("return",!1);case 3:return console.log("Connecting to Bluetooth server... "),e.next=6,n.gatt.connect();case 6:return r=e.sent,console.log("Connected. "),t(),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}return e.abrupt("return",!1);case 3:return console.log("Disconnecting the Bluetooth server... "),e.next=6,n.gatt.disconnect();case 6:return r=e.sent,console.log("Disconnected. "),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var y=function(){var e=Object(u.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(l.i)(t),e.next=4,r.getPrimaryService(d);case 4:return c=e.sent,e.next=7,c.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e");case 7:return a=e.sent,e.next=10,a.writeValue(t);case 10:return e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getPrimaryService(d);case 3:return c=e.sent,e.next=6,c.getCharacteristic("6e400003-b5a3-f393-e0a9-e50e24dcca9e");case 6:return i=e.sent,e.next=9,i.startNotifications();case 9:return e.next=11,i.addEventListener("characteristicvaluechanged",t);case 11:return console.log("Notifications have been started."),e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},160:function(e,t,a){"use strict";a.r(t);var n,r=a(12),c=a(13),i=a(15),s=a(14),o=a(0),u=a.n(o),l=a(19),d=a(25),m=a.n(d),p=a(33),f=a(89),h=a(20),b=a(99),v=a(85),y=a(23),g=a(100),k=a(32),O=a(86),j=a(87),x=a(101),S=a(91),C=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={record:{mobile:"",price:0,quantity:0,processed:0},metadata:Object(f.a)(O.c),socketState:!1,message:"",messageCode:"",saleProgress:!1},n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n)),n.refreshConnection=n.refreshConnection.bind(Object(h.a)(n)),n.responseReceived=n.responseReceived.bind(Object(h.a)(n)),n.onDeviceDisconnect=n.onDeviceDisconnect.bind(Object(h.a)(n)),n.onDeviceConnect=n.onDeviceConnect.bind(Object(h.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.responseReceived,this.props.dispatch(Object(b.c)());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetRecord",value:function(){this.setState({record:{mobile:"",price:0,quantity:0,processed:0}})}},{key:"refreshConnection",value:function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("refreshing"),e.next=4,Object(x.c)(this.onDeviceConnect,this.onDeviceDisconnect);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState({socketState:!1});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onDeviceConnect",value:function(){this.setState({socketState:!0}),n&&clearTimeout(n)}},{key:"handleSubmit",value:function(){var e=Object(p.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=this.state,n=a.record,a.socketState,!t){e.next=23;break}if(Object(v.f)(t.quantity)&&Object(v.f)(t.price)){e.next=6;break}return this.setState({message:"Enter valid quantity or price",messageCode:""}),e.abrupt("return",!1);case 6:if(n.mobile=t.mobile,!t.mobile){e.next=12;break}if(Object(v.a)(t.mobile)){e.next=12;break}return this.setState({message:"Enter valid Customer Id",messageCode:""}),e.abrupt("return",!1);case 12:if(n.price=t.price,n.quantity=t.quantity,n.customerName=t.name,this.setState({record:n,message:""}),n.quantity,!n.mobile||!Object(v.g)(n.mobile)){e.next=20;break}return this.props.dispatch(Object(b.d)(n)),e.abrupt("return",!0);case 20:this.props.dispatch(Object(b.a)(n)),e.next=24;break;case 23:alert("ensure the connection");case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),console.log(e.t0);case 29:case"end":return e.stop()}}),e,this,[[0,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"responseReceived",value:function(e){var t=this.state.record,a=e.target.value,n=Object(S.a)(a);console.log("data from bt",n),"done"===n?(this.setState({message:"Success: Sale: quantity: ".concat(t.quantity,", Price :").concat(t.price),saleProgress:!1}),this.props.dispatch(Object(b.a)(t)),this.resetRecord()):"error"===n?(t.processed>25?(t.quantity=t.processed>t.quantity?t.quantity:t.processed,t.price=Object(O.d)(t.quantity),this.setState({record:t}),this.props.dispatch(Object(b.a)(t)),this.setState({message:"Error:Sale : quantity: ".concat(t.quantity,", Price :").concat(t.price," "),saleProgress:!1})):this.setState({message:"Something went wrong",saleProgress:!1}),this.resetRecord()):isNaN(parseInt(n))||(t.processed=n,this.setState({record:t,saleProgress:!0}))}},{key:"onDeviceDisconnect",value:function(){var e=this,t=this.state.record;t.processed>25?(t.quantity=t.processed>t.quantity?t.quantity:t.processed,t.price=Object(O.d)(t.quantity),this.setState({record:t}),this.props.dispatch(Object(b.a)(t)),this.setState({socketState:!1,saleProgress:!1,message:"Error DC:Sale: quantity: ".concat(t.quantity,", Price :").concat(t.price,"   ")})):this.setState({socketState:!1,saleProgress:!1}),this.resetRecord(),n=setTimeout((function(){Object(x.a)(e.onDeviceConnect)}),1e3)}},{key:"componentWillUnmount",value:function(){this.resetRecord(),Object(x.b)(),n&&clearTimeout(n)}},{key:"render",value:function(){var e=this.state,t=e.record,a=t.quantity,n=t.processed,r=e.saleProgress,c=e.metadata,i=e.message,s=e.socketState,o={quantity:a,processed:n};return u.a.createElement("div",{className:"col-md-6 col-sm-12 form-items mb-55"},r?u.a.createElement(g.a,{params:o}):"",u.a.createElement(j.a,{data:c,button:{submit:!0,reset:!0},onSubmit:this.handleSubmit,title:"Add New Sale"}),i?u.a.createElement("p",{className:"text-primary text-center"},i):"",u.a.createElement("span",{className:"d-flex justify-content-center"},u.a.createElement("button",{className:"btn ".concat(s?"btn-success":"btn-danger","  m-3"),onClick:this.refreshConnection}," ",s?"Connected":"Not Connected")))}}],[{key:"getDerivedStateFromProps",value:function(){var e=Object(p.a)(m.a.mark((function e(t,a){var n,r,c,i,s,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.userData,r=n.transaction,c=r.message,i=r.messageCode,s=r.milkPrice,o=n.userInfo,u=a.record,!c){e.next=11;break}if("TC101"!==i){e.next=9;break}if(y.b.success(c),!o){e.next=7;break}return e.abrupt("return",{record:{mobile:"",price:0,quantity:0,processed:0}});case 7:e.next=10;break;case 9:"TV101"===i?(u.quantity+"",t.dispatch(Object(b.a)(u))):y.b.error(c);case 10:t.dispatch(Object(k.c)());case 11:return Object(O.i)(s),e.abrupt("return",{milkPrice:s});case 13:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}]),a}(u.a.Component),E=Object(l.b)((function(e){return{userData:e}}))(C),q=a(130),N=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){Object(v.c)(this.props),Object(v.j)(this.props)}},{key:"render",value:function(){var e=this.props.userData,t=e.users.userInfo,a=e.transaction.milkPrice,n="";return t&&(n=t.role),u.a.createElement("div",{className:"centered-items mb-55"},"salesman"===n?u.a.createElement(E,null):u.a.createElement("div",{className:"home"},u.a.createElement("div",{className:"main-card"},u.a.createElement("h4",null,"Welcome ".concat(t?t.name:"")),u.a.createElement("h6",null,"Fresh milk improves your health"),u.a.createElement("h5",null,u.a.createElement("label",null,"Today's milk price \u20b9"),a," ")),u.a.createElement("div",{className:"main-content"},u.a.createElement(q.default,{from:"home"}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Object(v.h)(e),null}}]),a}(u.a.Component);t.default=Object(l.b)((function(e){return{userData:e}}))(N)},87:function(e,t,a){"use strict";var n=a(25),r=a.n(n),c=a(33),i=a(12),s=a(13),o=a(20),u=a(15),l=a(14),d=a(0),m=a.n(d),p=a(93),f=a.n(p),h=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onCancel,a=e.onSucces;return m.a.createElement("div",{className:"full-overley",tabIndex:"0",onKeyPress:function(e){e.key&&t()}},m.a.createElement("div",{className:"popup-main"},m.a.createElement(f.a,{delay:300,showViewFinder:!1,facingMode:"environment",onError:function(e){console.log(e),t()},onScan:function(e){a(e)},style:{width:"100%"}}),m.a.createElement("span",{className:"qr-cancel"},m.a.createElement("button",{className:"btn btn-danger ",type:"button",onClick:t},"Cancel"))))}}]),a}(m.a.Component),b=a(94),v=a.n(b),y=a(85),g=a(88),k=(a(90),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={data:n.props.data},n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(o.a)(n)),n.resetData=n.resetData.bind(Object(o.a)(n)),n.refreshLocation=n.refreshLocation.bind(Object(o.a)(n)),n.hotKeyControl=n.hotKeyControl.bind(Object(o.a)(n)),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){v.a.bind("alt+o",this.hotKeyControl)}},{key:"hotKeyControl",value:function(){var e=this;this.state.data.forEach((function(t){t.qrcode&&e.qrControl("open",t)}))}},{key:"componentWillUnmount",value:function(){v.a.unbind("alt+o")}},{key:"handleChange",value:function(e,t){var a=this.state.data,n=e.target.value,r=a.findIndex((function(e){return e.id===t.id})),c=a[r];if(c.value=n,c.err="",c.formula){var i=a.findIndex((function(e){return e.id===t.formula.destination})),s=a[i];s.err="",s.value=c.formula.action(n)+"",""===s.value&&(c.value="")}this.setState({data:a})}},{key:"handleSubmit",value:function(e){try{e.preventDefault();var t=this.state.data,a={},n=!1;if(t.forEach((function(e,r){e.value+="";var c=e.value?e.value.trim():"";if(e.rules){var i=e.rules;if(i.required&&!Object(y.i)(c))return e.err=e.title+" is Required",n=!0,!1;if(i.length&&!Object(y.d)(c,i.min,i.max))return e.err=e.title+" should be minimum "+i.min+" characters and maximum "+i.max+" characters.",n=!0,!1;if(i.mobile&&!Object(y.g)(c))return e.err="Enter valid Mobile Number",n=!0,!1;if(i.email&&!Object(y.b)(c))return e.err="Enter valid email",n=!0,!1;if(i.location&&!Object(y.e)(c))return e.err="Invalid location, ie: 8.763250, 77457080",n=!0,!1}a[e.id]=c,"hidden"===e.type&&delete t[r]})),n)return this.setState({data:t}),!1;this.props.onSubmit(a),this.resetData()}catch(r){return console.log(r),{}}}},{key:"qrControl",value:function(e,t){try{if("open"===e)this.setState({qrStatus:!0,element:t});else if("close"===e)this.setState({qrStatus:!1});else if("set"===e&&t){t=JSON.parse(t);var a=this.state,n=a.data,r=a.element,c=n.findIndex((function(e){return e&&e.id===r.id})),i=n[c];i.value=t.name,i.err="";var s=n.findIndex((function(e){return e&&"mobile"===e.id}));if(-1!==s)n[s].value=t.mobile;else n.push({id:"mobile",value:t.mobile,type:"hidden"});this.setState({data:n,qrStatus:!1})}}catch(o){console.log(o)}}},{key:"refreshLocation",value:function(){var e=Object(c.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.b)();case 2:t=this.state.data,a=t.findIndex((function(e){return"location"===e.id})),(n=t[a]).value=localStorage.getItem("position"),n.err="",this.setState({data:t,qrStatus:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetData",value:function(){var e=this.state.data;e.forEach((function(e){e.value=e.default})),this.setState({data:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.qrStatus,r=this.props.button,c=r.submit,i=r.reset;return m.a.createElement("form",{className:"custom-form",onSubmit:this.handleSubmit},this.props.title&&m.a.createElement("h4",null,this.props.title),a&&a.map((function(t){return"hidden"!==t.type?m.a.createElement("div",{className:"form-group col p-0 m-1",key:t.id},t.title&&m.a.createElement("label",{htmlFor:t.id,className:"cap form-title"},t.title+" :"),"select"===t.type?m.a.createElement("select",{className:"form-control",id:"sel1",value:t.value,onChange:function(a){return e.handleChange(a,t)}},t.options&&t.options.length>0?t.options.map((function(e){return m.a.createElement("option",{key:e.key,value:e.key}," ",e.value)})):null):m.a.createElement(m.a.Fragment,null,m.a.createElement("input",{type:t.type,name:t.id,className:"form-control  ".concat(t.partitioned?"partitioned":"custom-input"," ").concat(t.err?"input-err":""),value:t.value,placeholder:t.placeholder,maxLength:t.maxLength?t.maxLength:50,autoFocus:!!t.autofocus,onChange:function(a){return e.handleChange(a,t)},autoComplete:"off",readOnly:!!t.readOnly}),t.qrcode?m.a.createElement("button",{className:"btn cam-position",type:"button",onClick:function(a){return e.qrControl("open",t)}},m.a.createElement("i",{className:"fa fa-qrcode cam-color"})):null,t.location?m.a.createElement("button",{className:"btn cam-position",type:"button",onClick:e.refreshLocation},m.a.createElement("i",{className:"fa fa-map-marker cam-color"})):null,t.hint&&m.a.createElement("span",null,t.hint),t.qrcode&&n?m.a.createElement(h,{onSucces:function(t){return e.qrControl("set",t)},onCancel:function(){return e.qrControl("close")}}):null),m.a.createElement("label",{className:"input-err text-danger"},t.err?t.err:"")):""})),m.a.createElement("div",{className:"form-group  col-12  d-flex justify-content-space-around"},i&&m.a.createElement("input",{type:"reset",className:"btn btn-danger",value:"Reset",onClick:this.resetData}),c&&m.a.createElement("input",{type:"submit",id:"form-submit",value:"Proceed",className:"btn btn-primary"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return JSON.stringify(e.data)!==JSON.stringify(t.data)?{data:e.data}:null}}]),a}(m.a.Component));t.a=k},88:function(e,t,a){"use strict";function n(){return new Promise((function(e,t){try{navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var a=t.coords.latitude+","+t.coords.longitude;localStorage.setItem("position",a),e(a)})):(alert("Geolocation is not supported by this browser."),t())}catch(a){t()}}))}a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return c}));var r=[{id:"name",title:"Name",type:"text",value:"",default:"",placeholder:"First name",rules:{required:!0,length:!0,min:3,max:30}},{id:"email",title:"Email",type:"email",value:"",default:"",placeholder:"i.e sample@abc.com",rules:{email:!0}},{id:"address",title:"Address",type:"text",value:"",default:"",placeholder:"Address line 1",rules:{required:!0}},{id:"pincode",title:"Pin Code",type:"Number",value:"",placeholder:"Enter 6 digit pincode",default:0,rules:{required:!0,length:!0,min:6,max:6}},{id:"location",title:"Location",type:"text",value:"",default:"",placeholder:"Enter location(10.8091781,78.2885026)",rules:{location:!0}}],c=[{id:"beneficiaryAccount",title:"Bank Account Number",type:"text",value:"",placeholder:"Enter Bank Account Number",default:"",rules:{required:!0,length:!0,min:9,max:18}},{id:"confirmbankAccNumber",title:"Confirm Bank Account Number",type:"text",value:"",default:"",placeholder:"Re enter Bank Account Number",rules:{required:!0,length:!0,min:9,max:18}},{id:"beneficiaryIFSC",title:"IFSC Code",type:"text",value:"",default:"",placeholder:"IFSC Code",rules:{required:!0,length:!0,min:11,max:11}}],i={signup:[{id:"name",title:"Name",type:"text",value:"",default:"",placeholder:"First name",rules:{required:!0,length:!0,min:3,max:30}},{id:"mobile",title:"Phone Number",type:"Number",value:"",default:"",placeholder:"your mobile number",rules:{required:!0,mobile:!0}},{id:"address1",title:"Address Line 1",type:"text",value:"",default:"",placeholder:"Address line 1",rules:{required:!0}},{id:"address2",title:"Address Line 2",type:"text",value:"",default:"",placeholder:"Address Line 2",rules:{required:!0}},{id:"location",title:"Location",location:!0,type:"text",value:"",default:"",readOnly:!0,placeholder:"Enter location(10.8091781,78.2885026)",rules:{required:!0}}],branchmanager:[{id:"role",title:"User Role",type:"select",value:"salesman",options:[{key:"salesman",value:"Sales Man",isDefault:!0},{key:"customer",value:"Customer"}],default:"salesman"}],admin:[{id:"role",title:"User Role",type:"select",value:"branchmanager",options:[{key:"branchmanager",value:"Branch Manager",isDefault:!0}],default:"branchmanager"},{id:"branchcode",title:"Assign Branch",type:"select",value:"",options:[{key:"select",value:"Select Value",isDefault:!0}],default:"",rules:{required:!0}}],root:[{id:"role",title:"User Role",type:"select",value:"admin",options:[{key:"admin",value:"Admin",isDefault:!0}],default:"admin"}],resetpassword:[{id:"newPassword",title:"New Password",type:"password",value:"",placeholder:"Minimum 8 characters",default:"",rules:{required:!0,length:!0,min:8,max:30}},{id:"confirmPassword",title:"Confirm Password",type:"password",value:"",default:"",placeholder:"Re enter your password",rules:{required:!0,length:!0,min:8,max:30}}],updateBankInfoForm:c,updateContactInfoForm:r};t.a=i},90:function(e,t,a){},99:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(2),r=a(4);function c(e){return Object(r.a)(n.b,"post","transaction",e)}function i(e){return Object(r.a)(n.S,"post","saleverify",e)}function s(){return Object(r.a)(n.p,"get","milkprice")}function o(e){return Object(r.a)(n.g,"delete","deltransaction",e)}}}]);