(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[13],{104:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(110),r=a.n(n);a(113);function i(e){return console.log("called"),new Promise((function(t,a){new Promise((function(e,t){window.recaptchaVerifier||(window.recaptchaVerifier=new r.a.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible"})),e()})).then((function(){var n=window.recaptchaVerifier;r.a.auth().signInWithPhoneNumber(e,n).then((function(e){window.confirmationResult=e,t()})).catch((function(e){console.log(e),a()}))})).catch((function(){a()}))}))}function o(e){return new Promise((function(t,a){window.confirmationResult.confirm(e).then((function(e){t()})).catch((function(e){console.log(e),a()}))}))}r.a.initializeApp({apiKey:"AIzaSyAMOyhvMHGaIxI14Nwapolrzx8pUStaG2c",authDomain:"level-footing-288902.firebaseapp.com",databaseURL:"https://level-footing-288902.firebaseio.com",projectId:"level-footing-288902",storageBucket:"level-footing-288902.appspot.com",messagingSenderId:"445813268704",appId:"1:445813268704:web:13735b2576e6b039347085",measurementId:"G-NKPW4M01F3"});r.a},122:function(e,t,a){},161:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a(13),i=a(20),o=a(15),l=a(14),s=a(0),u=a.n(s),c=a(19),d=a(98),m=a(23),f=a(32),p=a(104),h=a(87),b=a(88),v=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={metadata:b.a.resetpassword,message:""},r.resetPassword=r.resetPassword.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"resetPassword",value:function(e){var t=this;return e.confirmPassword!==e.newPassword?(setTimeout((function(){t.setState({message:""})}),3e3),this.setState({message:"Incorrect confirm password"})):this.props.onSubmit(e)}},{key:"render",value:function(){var e=this.state,t=e.metadata,a=e.message;return u.a.createElement("div",null,u.a.createElement(h.a,{data:t,onSubmit:this.resetPassword,button:{submit:!0,reset:!0},title:"Reset Password"}),u.a.createElement("p",{className:"text-danger"},a))}}]),a}(u.a.Component),y=a(35),g=(a(122),function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={userInfo:d.a.mobile,isNew:!0,otp:!1,title:"Login into Sivalingam Milks",isLoading:!1},r.verifyUser=r.verifyUser.bind(Object(i.a)(r)),r.resetRequest=r.resetRequest.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"verifyUser",value:function(e){var t=this,a=this.state,n=a.mobile,r=a.otp;if(e.mobile)this.setState({mobile:e.mobile,isLoading:!0}),this.props.dispatch(Object(f.u)(e));else if(e.mobile=n,this.setState({isLoading:!0}),e.code)Object(p.b)(e.code).then((function(){m.b.success("OTP verified"),r=!0,t.setState({otp:r,isLoading:!1})})).catch((function(e){m.b.error("Invalid OTP"),t.setState({isLoading:!1})}));else if(e.password)this.props.dispatch(Object(f.m)(e));else if(e.newPassword){e.password=e.newPassword;var i={mobile:n,password:e.newPassword};this.props.dispatch(Object(f.n)(i))}}},{key:"resetRequest",value:function(){var e=this,t=this.state,a=t.mobile,n=t.userInfo,r=t.title;this.setState({isLoading:!0}),a="+91"+a,Object(p.a)(a).then((function(){m.b.success("OTP sent to registed mobile"),n=d.a.code,r="Enter OTP",e.setState({userInfo:n,title:r,isLoading:!1})})).catch((function(){m.b.error("something went wrong"),e.setState({isLoading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.userInfo,a=e.otp,n=e.isNew,r=e.mobile,i=e.title,o=e.isLoading;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"row login mb-55"},u.a.createElement("div",{className:"p-0 col-md-6 col-xl-6 col-sm-12 login-bg"},u.a.createElement("div",{className:"login-banner"},u.a.createElement("span",null,u.a.createElement("h3",null,"Welcome back to Sivalingam Milks"),u.a.createElement("p",null,"To track your milk purchases,",u.a.createElement("br",null),"Pay your bills ,please use your personal information mobile number",u.a.createElement("br",null),"and password to login with us")))),u.a.createElement("div",{className:"p-0 col-md-6 col-xl-6 col-sm-12"},u.a.createElement("div",{className:"login-form"},u.a.createElement("span",{className:"login-form-container"},a?u.a.createElement(v,{onSubmit:this.verifyUser}):u.a.createElement(h.a,{data:t,onSubmit:this.verifyUser,title:i,button:{submit:!0,reset:!1}}),!n&&r?u.a.createElement("div",{className:"custom-link text-center",onClick:this.resetRequest},"Forget Password?"):"")))),o?u.a.createElement(y.a,null):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=t.userInfo,n=e.userData.users,r=n.message,i=n.messageCode,o=n.token,l=n.isNew,s="Login into Sivalingam Milks";if(r||i){if("UL101"===i)m.b.success(r),localStorage.setItem("token",o),e.dispatch(Object(f.c)()),setTimeout((function(){e.history.replace("/home")}),1e3);else if("UPR101"===i)m.b.success(r);else if("UM101"===i)m.b.success(r);else if(r)return e.dispatch(Object(f.c)()),m.b.error(r),{isLoading:!1};if("UPR101"===i)return a=d.a.mobile,e.dispatch(Object(f.c)()),{userInfo:a,isNew:l,mobile:"",title:s,otp:!1,isLoading:!1};if("UM101"===i){if(e.dispatch(Object(f.c)()),l){s="Enter OTP";var u="+91"+t.mobile;Object(p.a)(u).then((function(){m.b.success("OTP sent to registed mobile")})).catch((function(){m.b.error("something went wrong")})),a=d.a.code,s="Enter Received OTP"}else a=d.a.password,s="Enter your password";return{isNew:l,userInfo:a,title:s,isLoading:!1}}if("OT101"===i)return{userInfo:a=d.a.code,isNew:l,title:s,isLoading:!1}}return null}}]),a}(u.a.Component));t.default=Object(c.b)((function(e){return{userData:e}}))(g)},85:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m})),a.d(t,"h",(function(){return f})),a.d(t,"j",(function(){return p}));var n=a(32),r=a(86),i=function(e){return!!((e=e.trim())&&e.length>=3)&&e},o=function(e){return e>0},l=function(e){return!!e},s=function(e,t,a){return!!(e&&e.length>=t&&e.length<=a)},u=function(e){var t=new RegExp("^[6-9][0-9]{9}$");return!(!e||!t.test(e))},c=function(e){var t=new RegExp("^[a-zA-Z0-9_ .]+@[a-zA-Z0-9]+.[a-zA-Z]{2,3}$");return!(!e||!t.test(e))},d=function(e){var t=new RegExp("^[0-9]{1,2}[.][0-9]{5,16}, [0-9]{1,2}[.][0-9]{5,16}$");return!(!e||!t.test(e))},m=function(e){try{if(localStorage.getItem("token"))e.userData.users.token||e.dispatch(Object(n.t)());else e.history.push("/about")}catch(t){}},f=function(e){e.userData.users.token||(localStorage.getItem("token")||e.history.push("/about"))},p=function(e){var t=e.userData.users.userInfo,a=e.match.url,n=[];if(a&&t){var i=a.replace(/\/?\?[a-z=0-9]+/gi,"");if(i=i.replace("/",""),(n=r.b[i])&&n.length>0&&-1!==n.indexOf(t.role))return!0;e.history.push("/home")}}},86:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"j",(function(){return s})),a.d(t,"i",(function(){return u})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"h",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return h})),a.d(t,"e",(function(){return b}));var n={addsale:["salesman"],addwelcome:["salesman"],testsale:["admin"],emptycan:["branchmanager","salesman"],register:["salesman","branchmanager","admin","root"],collectbill:["salesman","branchmanager"],deposit:["salesman","branchmanager"],edit:["branchmanager","admin"],control:["branchmanager","admin","root"],delete:["admin","root"],view:["branchmanager","admin","root"],pending:["branchmanager","admin"],history:["customer","salesman","admin","branchmanager"],home:["customer","salesman","admin","branchmanager","root"],profile:["customer","salesman","admin","branchmanager","root"],statement:["customer","salesman","admin","branchmanager"],pstatement:["customer","salesman","admin","branchmanager"],paybill:["customer","salesman","branchmanager"],generateid:["branchmanager","admin","root"],manageuser:["branchmanager","admin","root"],payout:["admin"],salary:["salesman","branchmanager"],addbranch:["admin"],managebranch:["admin"],viewbranch:["admin"],deletebranch:["admin"],deletesales:["admin"]},r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=40,o=1e3,l=o/i,s=i/o;function u(e){l=(o=1e3)/(i=e),s=i/o}function c(e){if(e&&e<=9999){var t=Math.ceil(e*s);if(t<=499)return t}return""}var d=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",readOnly:!0,placeholder:"Scan QrCode",qrcode:!0},{id:"price",title:"Price",type:"Number",value:"",default:"",placeholder:"Enter price",formula:{destination:"quantity",action:function(e){if(e){var t=Math.ceil(e*l);if(t<=9999)return t}return""}},rules:{required:!0}},{id:"quantity",title:"Quantity(ml)",type:"Number",value:"",default:"",placeholder:"Enter quantity",formula:{destination:"price",action:c},rules:{required:!0}}],m=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type CONFIRM to collect security deposit ",rules:{required:!0}}],f=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type CONFIRM to add Welcome Offer",rules:{required:!0}}],p=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type DELETE to remove user permanently ",rules:{required:!0}}],h=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",readOnly:!0,placeholder:"Scan QrCode",qrcode:!0,rules:{required:!0}}],b=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type Collect to collect bill ",rules:{required:!0}}]},87:function(e,t,a){"use strict";var n=a(25),r=a.n(n),i=a(33),o=a(12),l=a(13),s=a(20),u=a(15),c=a(14),d=a(0),m=a.n(d),f=a(93),p=a.n(f),h=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onCancel,a=e.onSucces;return m.a.createElement("div",{className:"full-overley",tabIndex:"0",onKeyPress:function(e){e.key&&t()}},m.a.createElement("div",{className:"popup-main"},m.a.createElement(p.a,{delay:300,showViewFinder:!1,facingMode:"environment",onError:function(e){console.log(e),t()},onScan:function(e){a(e)},style:{width:"100%"}}),m.a.createElement("span",{className:"qr-cancel"},m.a.createElement("button",{className:"btn btn-danger ",type:"button",onClick:t},"Cancel"))))}}]),a}(m.a.Component),b=a(94),v=a.n(b),y=a(85),g=a(88),w=(a(90),function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={data:n.props.data},n.handleChange=n.handleChange.bind(Object(s.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(s.a)(n)),n.resetData=n.resetData.bind(Object(s.a)(n)),n.refreshLocation=n.refreshLocation.bind(Object(s.a)(n)),n.hotKeyControl=n.hotKeyControl.bind(Object(s.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){v.a.bind("alt+o",this.hotKeyControl)}},{key:"hotKeyControl",value:function(){var e=this;this.state.data.forEach((function(t){t.qrcode&&e.qrControl("open",t)}))}},{key:"componentWillUnmount",value:function(){v.a.unbind("alt+o")}},{key:"handleChange",value:function(e,t){var a=this.state.data,n=e.target.value,r=a.findIndex((function(e){return e.id===t.id})),i=a[r];if(i.value=n,i.err="",i.formula){var o=a.findIndex((function(e){return e.id===t.formula.destination})),l=a[o];l.err="",l.value=i.formula.action(n)+"",""===l.value&&(i.value="")}this.setState({data:a})}},{key:"handleSubmit",value:function(e){try{e.preventDefault();var t=this.state.data,a={},n=!1;if(t.forEach((function(e,r){e.value+="";var i=e.value?e.value.trim():"";if(e.rules){var o=e.rules;if(o.required&&!Object(y.i)(i))return e.err=e.title+" is Required",n=!0,!1;if(o.length&&!Object(y.d)(i,o.min,o.max))return e.err=e.title+" should be minimum "+o.min+" characters and maximum "+o.max+" characters.",n=!0,!1;if(o.mobile&&!Object(y.g)(i))return e.err="Enter valid Mobile Number",n=!0,!1;if(o.email&&!Object(y.b)(i))return e.err="Enter valid email",n=!0,!1;if(o.location&&!Object(y.e)(i))return e.err="Invalid location, ie: 8.763250, 77457080",n=!0,!1}a[e.id]=i,"hidden"===e.type&&delete t[r]})),n)return this.setState({data:t}),!1;this.props.onSubmit(a),this.resetData()}catch(r){return console.log(r),{}}}},{key:"qrControl",value:function(e,t){try{if("open"===e)this.setState({qrStatus:!0,element:t});else if("close"===e)this.setState({qrStatus:!1});else if("set"===e&&t){t=JSON.parse(t);var a=this.state,n=a.data,r=a.element,i=n.findIndex((function(e){return e&&e.id===r.id})),o=n[i];o.value=t.name,o.err="";var l=n.findIndex((function(e){return e&&"mobile"===e.id}));if(-1!==l)n[l].value=t.mobile;else n.push({id:"mobile",value:t.mobile,type:"hidden"});this.setState({data:n,qrStatus:!1})}}catch(s){console.log(s)}}},{key:"refreshLocation",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.b)();case 2:t=this.state.data,a=t.findIndex((function(e){return"location"===e.id})),(n=t[a]).value=localStorage.getItem("position"),n.err="",this.setState({data:t,qrStatus:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetData",value:function(){var e=this.state.data;e.forEach((function(e){e.value=e.default})),this.setState({data:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.qrStatus,r=this.props.button,i=r.submit,o=r.reset;return m.a.createElement("form",{className:"custom-form",onSubmit:this.handleSubmit},this.props.title&&m.a.createElement("h4",null,this.props.title),a&&a.map((function(t){return"hidden"!==t.type?m.a.createElement("div",{className:"form-group col p-0 m-1",key:t.id},t.title&&m.a.createElement("label",{htmlFor:t.id,className:"cap form-title"},t.title+" :"),"select"===t.type?m.a.createElement("select",{className:"form-control",id:"sel1",value:t.value,onChange:function(a){return e.handleChange(a,t)}},t.options&&t.options.length>0?t.options.map((function(e){return m.a.createElement("option",{key:e.key,value:e.key}," ",e.value)})):null):m.a.createElement(m.a.Fragment,null,m.a.createElement("input",{type:t.type,name:t.id,className:"form-control  ".concat(t.partitioned?"partitioned":"custom-input"," ").concat(t.err?"input-err":""),value:t.value,placeholder:t.placeholder,maxLength:t.maxLength?t.maxLength:50,autoFocus:!!t.autofocus,onChange:function(a){return e.handleChange(a,t)},autoComplete:"off",readOnly:!!t.readOnly}),t.qrcode?m.a.createElement("button",{className:"btn cam-position",type:"button",onClick:function(a){return e.qrControl("open",t)}},m.a.createElement("i",{className:"fa fa-qrcode cam-color"})):null,t.location?m.a.createElement("button",{className:"btn cam-position",type:"button",onClick:e.refreshLocation},m.a.createElement("i",{className:"fa fa-map-marker cam-color"})):null,t.hint&&m.a.createElement("span",null,t.hint),t.qrcode&&n?m.a.createElement(h,{onSucces:function(t){return e.qrControl("set",t)},onCancel:function(){return e.qrControl("close")}}):null),m.a.createElement("label",{className:"input-err text-danger"},t.err?t.err:"")):""})),m.a.createElement("div",{className:"form-group  col-12  d-flex justify-content-space-around"},o&&m.a.createElement("input",{type:"reset",className:"btn btn-danger",value:"Reset",onClick:this.resetData}),i&&m.a.createElement("input",{type:"submit",id:"form-submit",value:"Proceed",className:"btn btn-primary"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return JSON.stringify(e.data)!==JSON.stringify(t.data)?{data:e.data}:null}}]),a}(m.a.Component));t.a=w},88:function(e,t,a){"use strict";function n(){return new Promise((function(e,t){try{navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var a=t.coords.latitude+","+t.coords.longitude;localStorage.setItem("position",a),e(a)})):(alert("Geolocation is not supported by this browser."),t())}catch(a){t()}}))}a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i}));var r=[{id:"name",title:"Name",type:"text",value:"",default:"",placeholder:"First name",rules:{required:!0,length:!0,min:3,max:30}},{id:"email",title:"Email",type:"email",value:"",default:"",placeholder:"i.e sample@abc.com",rules:{email:!0}},{id:"address",title:"Address",type:"text",value:"",default:"",placeholder:"Address line 1",rules:{required:!0}},{id:"pincode",title:"Pin Code",type:"Number",value:"",placeholder:"Enter 6 digit pincode",default:0,rules:{required:!0,length:!0,min:6,max:6}},{id:"location",title:"Location",type:"text",value:"",default:"",placeholder:"Enter location(10.8091781,78.2885026)",rules:{location:!0}}],i=[{id:"beneficiaryAccount",title:"Bank Account Number",type:"text",value:"",placeholder:"Enter Bank Account Number",default:"",rules:{required:!0,length:!0,min:9,max:18}},{id:"confirmbankAccNumber",title:"Confirm Bank Account Number",type:"text",value:"",default:"",placeholder:"Re enter Bank Account Number",rules:{required:!0,length:!0,min:9,max:18}},{id:"beneficiaryIFSC",title:"IFSC Code",type:"text",value:"",default:"",placeholder:"IFSC Code",rules:{required:!0,length:!0,min:11,max:11}}],o={signup:[{id:"name",title:"Name",type:"text",value:"",default:"",placeholder:"First name",rules:{required:!0,length:!0,min:3,max:30}},{id:"mobile",title:"Phone Number",type:"Number",value:"",default:"",placeholder:"your mobile number",rules:{required:!0,mobile:!0}},{id:"address1",title:"Address Line 1",type:"text",value:"",default:"",placeholder:"Address line 1",rules:{required:!0}},{id:"address2",title:"Address Line 2",type:"text",value:"",default:"",placeholder:"Address Line 2",rules:{required:!0}},{id:"location",title:"Location",location:!0,type:"text",value:"",default:"",readOnly:!0,placeholder:"Enter location(10.8091781,78.2885026)",rules:{required:!0}}],branchmanager:[{id:"role",title:"User Role",type:"select",value:"salesman",options:[{key:"salesman",value:"Sales Man",isDefault:!0},{key:"customer",value:"Customer"}],default:"salesman"}],admin:[{id:"role",title:"User Role",type:"select",value:"branchmanager",options:[{key:"branchmanager",value:"Branch Manager",isDefault:!0}],default:"branchmanager"},{id:"branchcode",title:"Assign Branch",type:"select",value:"",options:[{key:"select",value:"Select Value",isDefault:!0}],default:"",rules:{required:!0}}],root:[{id:"role",title:"User Role",type:"select",value:"admin",options:[{key:"admin",value:"Admin",isDefault:!0}],default:"admin"}],resetpassword:[{id:"newPassword",title:"New Password",type:"password",value:"",placeholder:"Minimum 8 characters",default:"",rules:{required:!0,length:!0,min:8,max:30}},{id:"confirmPassword",title:"Confirm Password",type:"password",value:"",default:"",placeholder:"Re enter your password",rules:{required:!0,length:!0,min:8,max:30}}],updateBankInfoForm:i,updateContactInfoForm:r};t.a=o},90:function(e,t,a){},98:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(86);function r(e){return e?40*Math.ceil(e*n.j):""}var i=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",qrcode:!0,readOnly:!0,placeholder:"Scan QrCode",rules:{required:!0}},{id:"quantity",title:"Quantity(ml per day)",type:"Number",value:"",default:"",placeholder:"Enter milk quantity",formula:{destination:"deposit",action:r}},{id:"deposit",title:"Secure Deposit",type:"Number",value:"",default:"",placeholder:"Deposit amount",rules:{required:!0}}],o=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",qrcode:!0,readOnly:!0,placeholder:"Scan QrCode",rules:{required:!0}},{id:"quantity",title:"Quantity(ml per day)",type:"Number",value:"",default:"",placeholder:"Enter milk quantity",formula:{destination:"welcomeOffer",action:r}},{id:"welcomeOffer",title:"Welcome Offer Amount",type:"Number",value:"",default:"",placeholder:"Welcome offer amount",rules:{required:!0}}],l={mobile:[{id:"mobile",title:"Phone Number",type:"Number",value:"",default:"",placeholder:"Enter your mobile number",rules:{required:!0,mobile:!0}}],code:[{id:"code",title:"Verification Code",type:"text",value:"",default:"",placeholder:"Enter your OTP",rules:{required:!0}}],password:[{id:"password",title:"Password",type:"password",placeholder:"Password",value:"",default:"",rules:{required:!0,length:!0,min:8,max:30}}],deposit:i,welcomeOfferForm:o};t.a=l}}]);