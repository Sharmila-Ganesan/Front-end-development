(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[21],{100:function(e,t,n){"use strict";var r=n(12),a=n(13),c=n(15),o=n(14),s=n(0),i=n.n(s),u=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props.params,t=e.quantity,n=e.processed,r=Math.ceil(n/t*100);return r=isNaN(r)?0:r>100?100:r,i.a.createElement("div",{className:"sale-overflow"},i.a.createElement("div",{className:"row p-4 process-box  mb-55"},i.a.createElement("h3",{className:"col-12 p-1 "}," Processing..."),i.a.createElement("div",{className:"progress pbar"},i.a.createElement("div",{className:"progress-bar progress-bar-success progress-bar-striped ",role:"progressbar","aria-valuenow":r,"aria-valuemin":"0","aria-valuemax":"100",style:{width:"".concat(r,"%")}}," ".concat(r,"% Complete"))),i.a.createElement("h3",{className:"col-12 p-1"}," Processed ".concat(n," ml"))))}}]),n}(i.a.Component);t.a=u},101:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return y}));var r,a,c,o,s=n(25),i=n.n(s),u=n(33),l=n(91),d="6e400001-b5a3-f393-e0a9-e50e24dcca9e";function f(e,t){return p.apply(this,arguments)}function p(){return(p=Object(u.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={acceptAllDevices:!0,optionalServices:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]},console.log("Getting device info"),e.next=4,navigator.bluetooth.requestDevice(a);case 4:if(r=e.sent){e.next=7;break}throw Object.assign(new Error("No device Found"),{code:404});case 7:r.addEventListener("gattserverdisconnected",n),console.log("device connected"),m(t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}return e.abrupt("return",!1);case 3:return console.log("Connecting to Bluetooth server... "),e.next=6,r.gatt.connect();case 6:return a=e.sent,console.log("Connected. "),t(),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=3;break}return e.abrupt("return",!1);case 3:return console.log("Disconnecting the Bluetooth server... "),e.next=6,r.gatt.disconnect();case 6:return a=e.sent,console.log("Disconnected. "),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var g=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(l.i)(t),e.next=4,a.getPrimaryService(d);case 4:return c=e.sent,e.next=7,c.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e");case 7:return n=e.sent,e.next=10,n.writeValue(t);case 10:return e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.getPrimaryService(d);case 3:return c=e.sent,e.next=6,c.getCharacteristic("6e400003-b5a3-f393-e0a9-e50e24dcca9e");case 6:return o=e.sent,e.next=9,o.startNotifications();case 9:return e.next=11,o.addEventListener("characteristicvaluechanged",t);case 11:return console.log("Notifications have been started."),e.abrupt("return",!0);case 15:return e.prev=15,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},155:function(e,t,n){"use strict";n.r(t);var r,a,c=n(25),o=n.n(c),s=n(33),i=n(12),u=n(13),l=n(20),d=n(15),f=n(14),p=n(0),m=n.n(p),h=n(19),b=n(85),v=n(100),g=n(101),y=n(91),w=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={record:{mobile:"",price:0,quantity:4e4,processed:0},socketState:!1,message:"",messageCode:"",saleProgress:!1},r.handleSubmit=r.handleSubmit.bind(Object(l.a)(r)),r.refreshConnection=r.refreshConnection.bind(Object(l.a)(r)),r.responseReceived=r.responseReceived.bind(Object(l.a)(r)),r.onDeviceDisconnect=r.onDeviceDisconnect.bind(Object(l.a)(r)),r.onDeviceConnect=r.onDeviceConnect.bind(Object(l.a)(r)),r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(b.c)(this.props),Object(b.j)(this.props),r=this.responseReceived;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetRecord",value:function(){this.setState({record:{mobile:"",price:0,quantity:4e4,processed:0}})}},{key:"refreshConnection",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("refreshing"),e.next=4,Object(g.c)(this.onDeviceConnect,this.onDeviceDisconnect);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState({socketState:!1});case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onDeviceConnect",value:function(){this.setState({socketState:!0})}},{key:"handleSubmit",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.state.socketState){e.next=11;break}return this.setState({message:""}),"40000",e.next=7,Object(g.e)("40000");case 7:return e.next=9,Object(g.d)(r);case 9:e.next=12;break;case 11:alert("ensure the connection");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"responseReceived",value:function(e){var t=this.state.record,n=e.target.value,r=Object(y.a)(n);console.log("data from bt",r),"done"===r?(console.log("process done"),this.setState({message:"Success:Emptied : quantity ".concat(t.quantity),saleProgress:!1}),this.resetRecord()):"error"===r?(t.processed>25?(this.setState({message:"Error:Emptied : quantity ".concat(t.processed),saleProgress:!1}),this.resetRecord()):this.setState({message:"Something went wrong",saleProgress:!1}),this.resetRecord()):isNaN(parseInt(r))||(t.processed=r,this.setState({record:t,saleProgress:!0}))}},{key:"onDeviceDisconnect",value:function(){var e=this,t=this.state.record;t.processed>25?(t.quantity=t.processed,this.setState({socketState:!1,saleProgress:!1,message:"Error DC:Emptied : quantity ".concat(t.quantity)})):this.setState({socketState:!1,saleProgress:!1}),this.resetRecord(),a=setTimeout((function(){Object(g.a)(e.onDeviceConnect)}),1e3)}},{key:"componentWillUnmount",value:function(){this.resetRecord(),Object(g.b)(),a&&clearTimeout(a)}},{key:"render",value:function(){var e=this.state,t=e.record,n=t.quantity,r=t.processed,a=e.saleProgress,c=e.message,o=e.socketState,s={quantity:n,processed:r};return m.a.createElement("div",{className:"centered-items mb-55"},m.a.createElement("div",{className:"empty-can-div"},m.a.createElement("button",{className:"btn btn-primary m-3",onClick:this.handleSubmit},"Empty Can"),c?m.a.createElement("p",{className:"text-primary text-center"},c):"",m.a.createElement("button",{className:"btn ".concat(o?"btn-success":"btn-danger","  m-3"),onClick:this.refreshConnection}," ",o?"Connected":"Not Connected")),a?m.a.createElement(v.a,{params:s}):"")}}],[{key:"getDerivedStateFromProps",value:function(){var e=Object(s.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(b.h)(t),Object(b.j)(t),e.abrupt("return",{});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(m.a.Component);t.default=Object(h.b)((function(e){return{userData:e}}))(w)},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"j",(function(){return m}));var r=n(32),a=n(86),c=function(e){return!!((e=e.trim())&&e.length>=3)&&e},o=function(e){return e>0},s=function(e){return!!e},i=function(e,t,n){return!!(e&&e.length>=t&&e.length<=n)},u=function(e){var t=new RegExp("^[6-9][0-9]{9}$");return!(!e||!t.test(e))},l=function(e){var t=new RegExp("^[a-zA-Z0-9_ .]+@[a-zA-Z0-9]+.[a-zA-Z]{2,3}$");return!(!e||!t.test(e))},d=function(e){var t=new RegExp("^[0-9]{1,2}[.][0-9]{5,16}, [0-9]{1,2}[.][0-9]{5,16}$");return!(!e||!t.test(e))},f=function(e){try{if(localStorage.getItem("token"))e.userData.users.token||e.dispatch(Object(r.t)());else e.history.push("/about")}catch(t){}},p=function(e){e.userData.users.token||(localStorage.getItem("token")||e.history.push("/about"))},m=function(e){var t=e.userData.users.userInfo,n=e.match.url,r=[];if(n&&t){var c=n.replace(/\/?\?[a-z=0-9]+/gi,"");if(c=c.replace("/",""),(r=a.b[c])&&r.length>0&&-1!==r.indexOf(t.role))return!0;e.history.push("/home")}}},86:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return b}));var r={addsale:["salesman"],addwelcome:["salesman"],testsale:["admin"],emptycan:["branchmanager","salesman"],register:["salesman","branchmanager","admin","root"],collectbill:["salesman","branchmanager"],deposit:["salesman","branchmanager"],edit:["branchmanager","admin"],control:["branchmanager","admin","root"],delete:["admin","root"],view:["branchmanager","admin","root"],pending:["branchmanager","admin"],history:["customer","salesman","admin","branchmanager"],home:["customer","salesman","admin","branchmanager","root"],profile:["customer","salesman","admin","branchmanager","root"],statement:["customer","salesman","admin","branchmanager"],pstatement:["customer","salesman","admin","branchmanager"],paybill:["customer","salesman","branchmanager"],generateid:["branchmanager","admin","root"],manageuser:["branchmanager","admin","root"],payout:["admin"],salary:["salesman","branchmanager"],addbranch:["admin"],managebranch:["admin"],viewbranch:["admin"],deletebranch:["admin"],deletesales:["admin"]},a=["January","February","March","April","May","June","July","August","September","October","November","December"],c=40,o=1e3,s=o/c,i=c/o;function u(e){s=(o=1e3)/(c=e),i=c/o}function l(e){if(e&&e<=9999){var t=Math.ceil(e*i);if(t<=499)return t}return""}var d=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",readOnly:!0,placeholder:"Scan QrCode",qrcode:!0},{id:"price",title:"Price",type:"Number",value:"",default:"",placeholder:"Enter price",formula:{destination:"quantity",action:function(e){if(e){var t=Math.ceil(e*s);if(t<=9999)return t}return""}},rules:{required:!0}},{id:"quantity",title:"Quantity(ml)",type:"Number",value:"",default:"",placeholder:"Enter quantity",formula:{destination:"price",action:l},rules:{required:!0}}],f=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type CONFIRM to collect security deposit ",rules:{required:!0}}],p=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type CONFIRM to add Welcome Offer",rules:{required:!0}}],m=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type DELETE to remove user permanently ",rules:{required:!0}}],h=[{id:"name",title:"Customer Name",type:"text",value:"",default:"",readOnly:!0,placeholder:"Scan QrCode",qrcode:!0,rules:{required:!0}}],b=[{id:"confirm",title:"Consent",type:"text",value:"",default:"",placeholder:"Type Collect to collect bill ",rules:{required:!0}}]},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(26);var a=n(34);function c(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},91:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"j",(function(){return m}));var r=n(89),a=n(92);function c(e,t){var n=new Date(e),r=""+(n.getMonth()+1),a=""+n.getDate(),c=n.getFullYear(),o=n.getHours(),s=n.getMinutes();return o=o<=9?"0"+o:o,s=s<=9?"0"+s:s,r.length<2&&(r="0"+r),a.length<2&&(a="0"+a),"date"===t?[c,r,a].join("-"):"custom"===t?[a,r,c].join("-"):[a,r,c].join("/")+"-"+[o,s].join(":")}function o(e){if(/[\u0080-\uffff]/.test(e))throw new Error("this needs encoding, like UTF-8");for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return t.buffer}function s(e){var t=new Uint8Array(e.buffer),n=String.fromCharCode.apply(String,t);if(/[\u0080-\uffff]/.test(n))throw new Error("this string seems to contain (still encoded) multibytes");return n}function i(){var e=document.createElement("script");e.async=!0;e.src="https://securegw.paytm.in/merchantpgpui/checkoutjs/merchants/Sivali89602719243261.js",e.type="application/javascript",e.crossOrigin="anonymous",document.head.appendChild(e)}function u(e,t,n){var r=0,a=0,c=[];return e.forEach((function(e){-1!==(e[t]?e[t]+"":"").search(n)&&(c.push(e),r+=parseInt(e.price),a+=parseInt(e.quantity))})),[c,r,a]}function l(e,t){try{var n=e.orderId,r=e.amount,c=e.txnToken,o={root:"",flow:"DEFAULT",merchant:{name:"Sivalingam Milks",logo:a.a},data:{orderId:n,token:c,tokenType:"TXN_TOKEN",amount:r},handler:{notifyMerchant:t}};window.Paytm&&window.Paytm.CheckoutJS&&window.Paytm.CheckoutJS.init(o).then((function(){console.log("Before JS Checkout invoke"),window.Paytm.CheckoutJS.invoke()})).catch((function(e){console.log("Error => ",e)}))}catch(s){return!1}}function d(e,t,n){var r=[];return t?n.forEach((function(n){n[e]+""===t&&r.push(n)})):r=n,r}function f(e,t,n,a,c,o){var s=Object(r.a)(a);return c=[],o&&(o.role&&(s=d("role",o.role,s)),o.branchcode&&(s=d("branchcode",o.branchcode,s))),t&&n&&e?(t=new Date(t).setHours(0,0,0,0),n=new Date(n).setHours(0,0,0,0),s.forEach((function(r){var a=new Date(r[e]).setHours(0,0,0,0);a>=t&&a<=n&&c.push(r)}))):c=s,c}function p(e){try{var t=[];for(var n in e){var r=e[n];t.push({id:n,value:r,type:typeof r,default:r,title:n})}return t}catch(a){return[]}}function m(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r[a]=n.charCodeAt(a);return r}},92:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.ec169ce3.png"}}]);